<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioth√®que L3 √âco-Gestion</title>
    <style>
        :root { --main: #1e3a8a; --bg: #f8fafc; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #334155; margin: 0; padding: 15px; }
        .wrapper { max-width: 800px; margin: auto; }
        .search-area { background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; position: sticky; top: 10px; z-index: 100; }
        input { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px; outline: none; box-sizing: border-box; }
        .chip { padding: 6px 15px; border-radius: 20px; background: #f1f5f9; cursor: pointer; border: 1px solid #e2e8f0; font-size: 13px; font-weight: 600; margin-top: 10px; display: inline-block; }
        .chip.active { background: var(--main); color: #fff; }
        .card { background: #fff; padding: 20px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #e2e8f0; cursor: pointer; transition: 0.2s; }
        .card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .tag { font-size: 10px; text-transform: uppercase; font-weight: bold; padding: 3px 8px; border-radius: 4px; }
        .le√ßon { background: #dcfce7; color: #166534; }
        .exercice { background: #fef9c3; color: #854d0e; }
        .r√©ponse { background: #dbeafe; color: #1e40af; }
        /* Modal style for "Sokafana" effect */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; padding: 20px; box-sizing: border-box; }
        .modal-content { background: #fff; padding: 30px; border-radius: 20px; max-width: 600px; margin: auto; position: relative; max-height: 80px; overflow-y: auto; }
        .close { position: absolute; right: 20px; top: 10px; font-size: 25px; cursor: pointer; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="search-area">
        <h2 style="margin: 0 0 15px; font-size: 20px; color: var(--main);">üìö L3 √âCO-GESTION</h2>
        <input type="text" id="searchInput" placeholder="Tadiavo eto ny lesona..." oninput="searchData()">
        <div id="filters">
            <div class="chip active" onclick="setFilter('All', this)">Tous</div>
            <div class="chip" onclick="setFilter('Le√ßon', this)">Cours</div>
            <div class="chip" onclick="setFilter('Exercice', this)">Exercices</div>
        </div>
    </div>
    <div id="results">Chargement...</div>
</div>

<div id="myModal" class="modal" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="close" onclick="closeModal()">&times;</span>
        <div id="modalBody"></div>
    </div>
</div>

<script>
    let db = [];
    let filter = 'All';

    // Tena mila an'ity fetch ity ho feno mba handehanan'ny recherche
    fetch('database.json')
        .then(r => r.json())
        .then(data => {
            db = data;
            render(db);
        });

    function render(data) {
        const res = document.getElementById('results');
        res.innerHTML = data.length ? "" : "<p style='text-align:center;'>Tsy misy hita... üîç</p>";
        data.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = "card";
            div.onclick = () => openModal(item);
            div.innerHTML = `
                <span class="tag ${item.type.toLowerCase()}">${item.type}</span>
                <h3 style="margin:10px 0;">${item.titre}</h3>
                <p style="font-size:14px; color:#64748b;">Kitiho raha hamaky ny antsipiriany...</p>
            `;
            res.appendChild(div);
        });
    }

    function searchData() {
        const q = document.getElementById('searchInput').value.toLowerCase();
        const filtered = db.filter(i => 
            (i.titre.toLowerCase().includes(q) || i.matiere.toLowerCase().includes(query)) && 
            (filter === 'All' || i.type === filter)
        );
        render(filtered);
    }

    function setFilter(t, btn) {
        filter = t;
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        searchData();
    }

    function openModal(item) {
        const body = document.getElementById('modalBody');
        body.innerHTML = `
            <span class="tag ${item.type.toLowerCase()}">${item.type}</span>
            <h2>${item.titre}</h2>
            <hr>
            <div style="line-height:1.6; font-size:16px;">${item.contenu}</div>
        `;
        document.getElementById('myModal').style.display = "flex";
    }

    function closeModal() {
        document.getElementById('myModal').style.display = "none";
    }
</script>
</body>
</html>
